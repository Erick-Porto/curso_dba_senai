<h2><i class="fas fa-drafting-compass"></i> 3. Estratégias de Auditoria - Como Coletar Evidências?</h2>
<p>Existem várias abordagens para implementar a auditoria, cada uma com seus prós e contras:</p>
<div class="slide-svg-container" style="margin-bottom:15px;">
    <svg width="400" height="180" viewBox="0 0 400 180">
        <title>Estratégias de Auditoria</title>
        <!-- Hub Central -->
        <circle cx="200" cy="90" r="40" fill="var(--accent-blue)"/>
        <text x="200" y="95" fill="white" font-size="10" text-anchor="middle">Coleta de</text>
        <text x="200" y="107" fill="white" font-size="10" text-anchor="middle">Auditoria</text>
        <animateTransform attributeName="transform" type="rotate" from="0 200 90" to="360 200 90" dur="20s" repeatCount="indefinite"/>

        <!-- Fontes de Auditoria -->
        <g class="audit-source" id="source-logs">
            <rect x="30" y="20" width="100" height="30" rx="5" fill="var(--bg-light)" stroke="var(--accent-green)"/>
            <text x="80" y="40" fill="var(--text-light)" font-size="10" text-anchor="middle">Logs Nativos SGBD</text>
            <path d="M130 35 Q160 50 180 70" stroke="var(--accent-green)" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
        </g>
        <g class="audit-source" id="source-triggers">
            <rect x="30" y="130" width="100" height="30" rx="5" fill="var(--bg-light)" stroke="var(--accent-green)"/>
            <text x="80" y="150" fill="var(--text-light)" font-size="10" text-anchor="middle">Triggers de BD</text>
            <path d="M130 145 Q160 130 180 110" stroke="var(--accent-green)" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
        </g>
        <g class="audit-source" id="source-tools">
            <rect x="270" y="20" width="100" height="30" rx="5" fill="var(--bg-light)" stroke="var(--accent-green)"/>
            <text x="320" y="40" fill="var(--text-light)" font-size="10" text-anchor="middle">Ferramentas Externas</text>
            <path d="M270 35 Q240 50 220 70" stroke="var(--accent-green)" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
        </g>
        <g class="audit-source" id="source-views">
             <rect x="270" y="130" width="100" height="30" rx="5" fill="var(--bg-light)" stroke="var(--accent-green)"/>
            <text x="320" y="150" fill="var(--text-light)" font-size="10" text-anchor="middle">Views/Tabelas Aux.</text>
            <path d="M270 145 Q240 130 220 110" stroke="var(--accent-green)" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
        </g>
        <defs><marker id="arrowGreen" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="var(--accent-green)" /></marker></defs>
        <style> .audit-source { animation: sourcePulse 3s infinite ease-in-out alternate; } #source-triggers { animation-delay: 0.5s; } #source-tools { animation-delay: 1s; } #source-views { animation-delay: 1.5s; } @keyframes sourcePulse{ 0%{opacity:0.7;} 100%{opacity:1;} } </style>
    </svg>
</div>

<div style="text-align: left; max-width: 800px; margin: 0px auto;">
    <ul style="list-style: none; padding-left: 0;">
        <li><strong><i class="fas fa-align-left" style="color:var(--accent-blue);"></i> Auditoria baseada em Logs Nativos do SGBD:</strong>
            <p style="font-size:0.9em; color:var(--text-medium); margin-left:20px;">Utiliza os mecanismos de logging do próprio SGBD (ex: General Log, Binlog no MySQL; pg_log no PostgreSQL). Prós: integrado, baixo overhead se bem configurado. Contras: pode gerar muito volume, formato pode não ser ideal para análise de auditoria específica, nem sempre captura todos os detalhes (ex: valores antigos/novos de um UPDATE sem plugins).</p>
        </li>
        <li><strong><i class="fas fa-bolt" style="color:var(--accent-blue);"></i> Auditoria via Triggers (Gatilhos de Monitoramento):</strong>
            <p style="font-size:0.9em; color:var(--text-medium); margin-left:20px;">Cria-se código (triggers) que é executado automaticamente em resposta a eventos DML (INSERT, UPDATE, DELETE) em tabelas específicas, inserindo registros em tabelas de log dedicadas. Prós: altamente customizável, captura detalhes finos. Contras: adiciona overhead às operações DML, complexidade de gerenciar triggers e tabelas de log.</p>
        </li>
        <li><strong><i class="fas fa-eye" style="color:var(--accent-blue);"></i> Auditoria via Views e Tabelas Auxiliares:</strong>
            <p style="font-size:0.9em; color:var(--text-medium); margin-left:20px;">Menos comum para auditoria completa. Views podem controlar o acesso e, com lógica adicional, registrar consultas. Tabelas auxiliares são frequentemente usadas por triggers para armazenar os logs.</p>
        </li>
        <li><strong><i class="fas fa-network-wired" style="color:var(--accent-blue);"></i> Auditoria via Ferramentas Externas (SIEM, Agentes):</strong>
            <p style="font-size:0.9em; color:var(--text-medium); margin-left:20px;">Soluções especializadas (Splunk, ELK, Graylog) que coletam, correlacionam e analisam logs de diversas fontes, incluindo SGBDs. Agentes no servidor de BD podem capturar eventos. Prós: visão centralizada, análise avançada. Contras: custo, complexidade.</p>
        </li>
    </ul>
</div>
<img src="https://img.freepik.com/vetores-gratis/copie-o-fundo-digital-dos-circuitos-azuis-do-espaco_23-2148821699.jpg?t=st=1744579714~exp=1744583314~hmac=fa320b526841e6112955661ca2a1d097a9b09fb93e2b51e1dd1ff789916ab402&w=996" alt="Technology Background" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.1; z-index: -1;"/>